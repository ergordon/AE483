function HW24()
P2
end

function [Ad,Bd] = P1()
    Ac = [0.10 -3.93 -2.66 -3.25; 2.52 2.95 -4.13 1.78; -2.20 3.40 -2.78 -0.64; -4.17 -3.35 -3.19 -4.22];
    Bc = [2.97; 2.76; 0.02; 3.12];
    dt = 0.82;

    syms tau real

    Ad = expm(Ac*dt);
    Bd = integral(@(tau) f(Ac, tau, Bc),0,dt,'ArrayValued',true);

    mat2str(Ad)
    mat2str(Bd)
end

function f = f(Ac, tau, Bc)
    f= expm(Ac*tau)*Bc;
end

function  P2
    g = 9.8100000000;
    m = 0.5316821316;
    J = [0.0041604531 0.0000000000 0.0000000000; 0.0000000000 0.0039642096 0.0000000000; 0.0000000000 0.0000000000 0.0068229104];
    theta1 = -2.6679649172;
    dt = 0.7600000000;

    iJ = inv(J);

    Ac = [0 0 0 0 0 0 1 0 0 0 0 0;...
        0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0;...
        0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;...
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;... 
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;...
        0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;...
        0, 0, 0, 0, -cos(theta1)*g, -sin(theta1)*g, 0, 0, 0, 0, 0, 0;...
        0, 0, 0, 0, -sin(theta1)*g, cos(theta1)*g, 0, 0, 0, 0, 0, 0;...
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;...
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;...
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;...
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];

    Bc = [0, 0, 0, 0;...
        0, 0, 0, 0; ...
        0, 0, 0, 0;...
        0, 0, 0, 0;...
        0, 0, 0, 0;...
        0, 0, 0, 0;...
        0, 0, 0, 0;...
        0, 0, 0, 0;...
        0, 0, 0, -1/m;...
        iJ(1,1), 0, 0, 0;...
        0, iJ(2,2), 0, 0;...
        0, 0, iJ(3,3), 0];

    syms tau real

    Ad = expm(Ac*dt);
    Bd = integral(@(tau) f(Ac, tau, Bc),0,dt,'ArrayValued',true);

    mat2str(Ad)
    mat2str(Bd)
end